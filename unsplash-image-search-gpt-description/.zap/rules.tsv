# ZAP Security Scan Rules Configuration
# Format: IGNORE/WARN/FAIL	RULE_ID	URL_REGEX	PARAMETER	EVIDENCE

# Ignore common false positives
IGNORE	10021	.*\.js$	.*	.*		# Loosely Scoped Cookie - common in SPAs
IGNORE	10054	.*	.*	.*		# Cookie with SameSite Attribute - handled by framework
IGNORE	10096	.*	.*	X-Frame-Options	.*	# Timestamp Disclosure - acceptable for logs
IGNORE	10027	.*	.*	.*		# Information Disclosure - Suspicious Comments

# Critical security issues that should fail the scan
FAIL	40018	.*	.*	.*		# SQL Injection
FAIL	40019	.*	.*	.*		# SQL Injection - MySQL
FAIL	40020	.*	.*	.*		# SQL Injection - Hypersonic SQL
FAIL	40021	.*	.*	.*		# SQL Injection - Oracle
FAIL	40022	.*	.*	.*		# SQL Injection - PostgreSQL
FAIL	40023	.*	.*	.*		# Possible Username Enumeration
FAIL	40024	.*	.*	.*		# SQL Injection - SQLite
FAIL	40025	.*	.*	.*		# Proxy Disclosure
FAIL	40026	.*	.*	.*		# Cross Site Scripting (Reflected)
FAIL	40027	.*	.*	.*		# Cross Site Scripting (Persistent)
FAIL	40028	.*	.*	.*		# Cross Site Scripting (Persistent) - Prime
FAIL	40029	.*	.*	.*		# Cross Site Scripting (Persistent) - Spider
FAIL	40012	.*	.*	.*		# Cross Site Request Forgery
FAIL	40014	.*	.*	.*		# Cross Site Request Forgery
FAIL	40016	.*	.*	.*		# Cross Site Request Forgery
FAIL	40017	.*	.*	.*		# Cross Site Request Forgery

# High severity warnings
WARN	10020	.*	.*	.*		# X-Frame-Options Header Not Set
WARN	10016	.*	.*	.*		# Web Browser XSS Protection Not Enabled
WARN	10017	.*	.*	.*		# Cross-Domain JavaScript Source File Inclusion
WARN	10019	.*	.*	.*		# Content-Type Header Missing
WARN	10015	.*	.*	.*		# Incomplete or No Cache-control and Pragma HTTP Header Set
WARN	10036	.*	.*	.*		# Server Leaks Version Information
WARN	10037	.*	.*	.*		# Server Leaks Information via "X-Powered-By" HTTP Response Header
WARN	10038	.*	.*	.*		# Content Security Policy (CSP) Header Not Set
WARN	10039	.*	.*	.*		# X-Content-Type-Options Header Missing

# API specific rules
WARN	10109	.*\/api\/.*	.*	.*	# Modern Web Application - API endpoints should use HTTPS
FAIL	40033	.*\/api\/.*	.*	.*	# NoSQL Injection - MongoDB
FAIL	40034	.*\/api\/.*	.*	.*	# .htaccess Information Leak

# PWA specific ignores
IGNORE	10049	.*\/sw\.js$	.*	.*	# Service Worker - Storable and Cacheable Content
IGNORE	10049	.*\/manifest\.json$	.*	.*	# PWA Manifest - Storable and Cacheable Content
IGNORE	10049	.*\/_next\/static\/.*	.*	.*	# Next.js static assets - expected to be cached

# Authentication related
WARN	10105	.*\/api\/auth\/.*	.*	.*	# Weak Authentication Method
FAIL	40031	.*\/login.*	.*	.*	# HTTP Parameter Override
FAIL	40032	.*\/auth\/.*	.*	.*	# HTTP Parameter Override