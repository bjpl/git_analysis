<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Space Converter</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2d3748;
            margin-bottom: 30px;
            text-align: center;
        }
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4a5568;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #4299e1;
        }
        .color-preview {
            width: 100%;
            height: 100px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .color-space {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }
        .color-space h3 {
            margin: 0 0 10px 0;
            color: #2b6cb0;
            font-size: 16px;
        }
        .value-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .gamut-visualization {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        .gamut-chart {
            width: 100%;
            height: 300px;
            border: 1px solid #ccc;
            margin: 10px 0;
        }
        .info-panel {
            background: #ebf8ff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .slider-container input[type="range"] {
            flex: 1;
        }
        .slider-value {
            min-width: 50px;
            text-align: right;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #4a5568;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Color Space Converter</h1>
        
        <div class="color-preview" id="colorPreview"></div>
        
        <div class="controls">
            <div>
                <h3>Input</h3>
                <div class="input-group">
                    <label for="inputSpace">Input Color Space:</label>
                    <select id="inputSpace">
                        <option value="sRGB">sRGB</option>
                        <option value="Adobe RGB">Adobe RGB</option>
                        <option value="DCI-P3">DCI-P3</option>
                        <option value="Rec. 2020">Rec. 2020</option>
                        <option value="CIE XYZ">CIE XYZ</option>
                        <option value="CIE Lab">CIE Lab</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Red/X/L:</label>
                    <div class="slider-container">
                        <input type="range" id="value1" min="0" max="255" value="128">
                        <span class="slider-value" id="value1Display">128</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Green/Y/a:</label>
                    <div class="slider-container">
                        <input type="range" id="value2" min="0" max="255" value="128">
                        <span class="slider-value" id="value2Display">128</span>
                    </div>
                </div>
                <div class="input-group">
                    <label>Blue/Z/b:</label>
                    <div class="slider-container">
                        <input type="range" id="value3" min="0" max="255" value="128">
                        <span class="slider-value" id="value3Display">128</span>
                    </div>
                </div>
            </div>
            
            <div>
                <h3>Display Properties</h3>
                <div class="input-group">
                    <label for="whitePoint">White Point:</label>
                    <select id="whitePoint">
                        <option value="D65">D65 (6500K)</option>
                        <option value="D50">D50 (5000K)</option>
                        <option value="D75">D75 (7500K)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="gamma">Gamma:</label>
                    <div class="slider-container">
                        <input type="range" id="gamma" min="1.0" max="3.0" step="0.1" value="2.2">
                        <span class="slider-value" id="gammaDisplay">2.2</span>
                    </div>
                </div>
                <div class="input-group">
                    <label for="brightness">Brightness (nits):</label>
                    <div class="slider-container">
                        <input type="range" id="brightness" min="100" max="1000" step="50" value="300">
                        <span class="slider-value" id="brightnessDisplay">300</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="results-grid" id="results">
            <!-- Results will be populated by JavaScript -->
        </div>
        
        <div class="gamut-visualization">
            <h3>Color Gamut Comparison</h3>
            <canvas id="gamutChart" class="gamut-chart"></canvas>
            <p>CIE 1931 chromaticity diagram showing color space coverage</p>
        </div>
        
        <div class="info-panel">
            <h3>Color Space Information</h3>
            <div id="colorSpaceInfo">
                <!-- Information will be updated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Color space conversion matrices and information
        const colorSpaces = {
            'sRGB': {
                description: 'Standard RGB color space for web and consumer displays',
                gamutPercentage: 35,
                whitePoint: 'D65',
                gamma: 2.2,
                matrix: [ // XYZ to RGB
                    [3.2406, -1.5372, -0.4986],
                    [-0.9689, 1.8758, 0.0415],
                    [0.0557, -0.2040, 1.0570]
                ]
            },
            'Adobe RGB': {
                description: 'Wide gamut color space for photography and professional printing',
                gamutPercentage: 50,
                whitePoint: 'D65',
                gamma: 2.2,
                matrix: [
                    [2.0413, -0.5649, -0.3447],
                    [-0.9692, 1.8760, 0.0416],
                    [0.0134, -0.1183, 0.9420]
                ]
            },
            'DCI-P3': {
                description: 'Digital cinema color space, 25% larger than sRGB',
                gamutPercentage: 45,
                whitePoint: 'D65',
                gamma: 2.6,
                matrix: [
                    [2.7253, -1.0180, -0.4401],
                    [-0.7951, 1.6897, 0.0226],
                    [0.0412, -0.0876, 0.9064]
                ]
            },
            'Rec. 2020': {
                description: 'Ultra-wide gamut for 8K broadcast and future displays',
                gamutPercentage: 75,
                whitePoint: 'D65',
                gamma: 2.4,
                matrix: [
                    [1.7166, -0.3557, -0.2533],
                    [-0.6667, 1.6165, 0.0157],
                    [0.0176, -0.0428, 0.9421]
                ]
            }
        };
        
        function updateSliderDisplays() {
            document.getElementById('value1Display').textContent = document.getElementById('value1').value;
            document.getElementById('value2Display').textContent = document.getElementById('value2').value;
            document.getElementById('value3Display').textContent = document.getElementById('value3').value;
            document.getElementById('gammaDisplay').textContent = document.getElementById('gamma').value;
            document.getElementById('brightnessDisplay').textContent = document.getElementById('brightness').value;
        }
        
        function updateInputLabels() {
            const inputSpace = document.getElementById('inputSpace').value;
            const labels = document.querySelectorAll('.input-group label');
            
            switch(inputSpace) {
                case 'CIE XYZ':
                    labels[1].textContent = 'X:';
                    labels[2].textContent = 'Y:';
                    labels[3].textContent = 'Z:';
                    break;
                case 'CIE Lab':
                    labels[1].textContent = 'L*:';
                    labels[2].textContent = 'a*:';
                    labels[3].textContent = 'b*:';
                    break;
                default:
                    labels[1].textContent = 'Red:';
                    labels[2].textContent = 'Green:';
                    labels[3].textContent = 'Blue:';
            }
        }
        
        function rgbToXyz(r, g, b) {
            // Convert to 0-1 range
            r = r / 255;
            g = g / 255;
            b = b / 255;
            
            // Apply gamma correction
            r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;
            g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;
            b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;
            
            // sRGB to XYZ matrix
            const x = r * 0.4124 + g * 0.3576 + b * 0.1805;
            const y = r * 0.2126 + g * 0.7152 + b * 0.0722;
            const z = r * 0.0193 + g * 0.1192 + b * 0.9505;
            
            return [x * 100, y * 100, z * 100];
        }
        
        function xyzToRgb(x, y, z, colorSpace = 'sRGB') {
            // Normalize XYZ
            x = x / 100;
            y = y / 100;
            z = z / 100;
            
            // Use color space matrix
            const matrix = colorSpaces[colorSpace]?.matrix || colorSpaces['sRGB'].matrix;
            
            let r = x * matrix[0][0] + y * matrix[0][1] + z * matrix[0][2];
            let g = x * matrix[1][0] + y * matrix[1][1] + z * matrix[1][2];
            let b = x * matrix[2][0] + y * matrix[2][1] + z * matrix[2][2];
            
            // Apply gamma correction
            r = r > 0.0031308 ? 1.055 * Math.pow(r, 1/2.4) - 0.055 : 12.92 * r;
            g = g > 0.0031308 ? 1.055 * Math.pow(g, 1/2.4) - 0.055 : 12.92 * g;
            b = b > 0.0031308 ? 1.055 * Math.pow(b, 1/2.4) - 0.055 : 12.92 * b;
            
            // Clamp to 0-255
            r = Math.max(0, Math.min(255, Math.round(r * 255)));
            g = Math.max(0, Math.min(255, Math.round(g * 255)));
            b = Math.max(0, Math.min(255, Math.round(b * 255)));
            
            return [r, g, b];
        }
        
        function xyzToLab(x, y, z) {
            // Reference white point D65
            const xn = 95.047, yn = 100.000, zn = 108.883;
            
            x = x / xn;
            y = y / yn;
            z = z / zn;
            
            x = x > 0.008856 ? Math.pow(x, 1/3) : (7.787 * x) + (16/116);
            y = y > 0.008856 ? Math.pow(y, 1/3) : (7.787 * y) + (16/116);
            z = z > 0.008856 ? Math.pow(z, 1/3) : (7.787 * z) + (16/116);
            
            const l = (116 * y) - 16;
            const a = 500 * (x - y);
            const b = 200 * (y - z);
            
            return [l, a, b];
        }
        
        function updateConversions() {
            const v1 = parseInt(document.getElementById('value1').value);
            const v2 = parseInt(document.getElementById('value2').value);
            const v3 = parseInt(document.getElementById('value3').value);
            const inputSpace = document.getElementById('inputSpace').value;
            
            let rgb, xyz, lab;
            
            // Convert input to RGB for preview
            if (inputSpace.includes('RGB') || inputSpace === 'DCI-P3') {
                rgb = [v1, v2, v3];
                xyz = rgbToXyz(v1, v2, v3);
            } else if (inputSpace === 'CIE XYZ') {
                xyz = [v1, v2, v3];
                rgb = xyzToRgb(v1, v2, v3);
            } else if (inputSpace === 'CIE Lab') {
                // Lab to XYZ conversion would go here
                rgb = [128, 128, 128]; // Placeholder
                xyz = [50, 50, 50];\n            }\n            \n            lab = xyzToLab(xyz[0], xyz[1], xyz[2]);\n            \n            // Update color preview\n            const preview = document.getElementById('colorPreview');\n            preview.style.backgroundColor = `rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]})`;\n            \n            // Update results\n            const results = document.getElementById('results');\n            results.innerHTML = `\n                <div class=\"color-space\">\n                    <h3>sRGB</h3>\n                    <div class=\"value-row\"><span>R:</span><span>${rgb[0]}</span></div>\n                    <div class=\"value-row\"><span>G:</span><span>${rgb[1]}</span></div>\n                    <div class=\"value-row\"><span>B:</span><span>${rgb[2]}</span></div>\n                    <div class=\"value-row\"><span>Hex:</span><span>#${rgb.map(v => v.toString(16).padStart(2, '0')).join('')}</span></div>\n                </div>\n                <div class=\"color-space\">\n                    <h3>CIE XYZ</h3>\n                    <div class=\"value-row\"><span>X:</span><span>${xyz[0].toFixed(2)}</span></div>\n                    <div class=\"value-row\"><span>Y:</span><span>${xyz[1].toFixed(2)}</span></div>\n                    <div class=\"value-row\"><span>Z:</span><span>${xyz[2].toFixed(2)}</span></div>\n                </div>\n                <div class=\"color-space\">\n                    <h3>CIE Lab</h3>\n                    <div class=\"value-row\"><span>L*:</span><span>${lab[0].toFixed(2)}</span></div>\n                    <div class=\"value-row\"><span>a*:</span><span>${lab[1].toFixed(2)}</span></div>\n                    <div class=\"value-row\"><span>b*:</span><span>${lab[2].toFixed(2)}</span></div>\n                </div>\n                <div class=\"color-space\">\n                    <h3>Adobe RGB</h3>\n                    ${generateRGBOutput(xyz, 'Adobe RGB')}\n                </div>\n                <div class=\"color-space\">\n                    <h3>DCI-P3</h3>\n                    ${generateRGBOutput(xyz, 'DCI-P3')}\n                </div>\n                <div class=\"color-space\">\n                    <h3>Rec. 2020</h3>\n                    ${generateRGBOutput(xyz, 'Rec. 2020')}\n                </div>\n            `;\n            \n            updateColorSpaceInfo(inputSpace);\n            drawGamutChart();\n        }\n        \n        function generateRGBOutput(xyz, colorSpace) {\n            const rgb = xyzToRgb(xyz[0], xyz[1], xyz[2], colorSpace);\n            return `\n                <div class=\"value-row\"><span>R:</span><span>${rgb[0]}</span></div>\n                <div class=\"value-row\"><span>G:</span><span>${rgb[1]}</span></div>\n                <div class=\"value-row\"><span>B:</span><span>${rgb[2]}</span></div>\n                <div class=\"value-row\"><span>In Gamut:</span><span>${isInGamut(rgb) ? 'Yes' : 'No'}</span></div>\n            `;\n        }\n        \n        function isInGamut(rgb) {\n            return rgb.every(v => v >= 0 && v <= 255);\n        }\n        \n        function updateColorSpaceInfo(currentSpace) {\n            const info = colorSpaces[currentSpace];\n            if (info) {\n                document.getElementById('colorSpaceInfo').innerHTML = `\n                    <h4>${currentSpace}</h4>\n                    <p><strong>Description:</strong> ${info.description}</p>\n                    <p><strong>Gamut Coverage:</strong> ~${info.gamutPercentage}% of visible spectrum</p>\n                    <p><strong>White Point:</strong> ${info.whitePoint}</p>\n                    <p><strong>Gamma:</strong> ${info.gamma}</p>\n                `;\n            }\n        }\n        \n        function drawGamutChart() {\n            const canvas = document.getElementById('gamutChart');\n            const ctx = canvas.getContext('2d');\n            \n            // Set canvas size\n            canvas.width = canvas.offsetWidth;\n            canvas.height = canvas.offsetHeight;\n            \n            const width = canvas.width;\n            const height = canvas.height;\n            \n            // Clear canvas\n            ctx.fillStyle = '#ffffff';\n            ctx.fillRect(0, 0, width, height);\n            \n            // Draw CIE 1931 outline (simplified)\n            ctx.strokeStyle = '#333333';\n            ctx.lineWidth = 2;\n            ctx.beginPath();\n            \n            // Simplified spectral locus\n            const spectralPoints = [\n                [0.175, 0.005], [0.17, 0.02], [0.16, 0.04], [0.13, 0.065],\n                [0.08, 0.12], [0.04, 0.2], [0.02, 0.26], [0.008, 0.325],\n                [0.003, 0.39], [0.001, 0.455], [0.0008, 0.52], [0.002, 0.585],\n                [0.01, 0.65], [0.04, 0.71], [0.08, 0.76], [0.15, 0.79],\n                [0.23, 0.78], [0.32, 0.75], [0.41, 0.69], [0.5, 0.6],\n                [0.58, 0.48], [0.65, 0.35], [0.7, 0.25], [0.72, 0.15],\n                [0.735, 0.08]\n            ];\n            \n            // Draw spectral locus\n            for (let i = 0; i < spectralPoints.length; i++) {\n                const x = spectralPoints[i][0] * width;\n                const y = height - (spectralPoints[i][1] * height);\n                if (i === 0) ctx.moveTo(x, y);\n                else ctx.lineTo(x, y);\n            }\n            \n            // Close with purple line\n            ctx.lineTo(spectralPoints[0][0] * width, height - (spectralPoints[0][1] * height));\n            ctx.stroke();\n            \n            // Draw color space triangles\n            const spaces = {\n                'sRGB': {color: '#ff4444', points: [[0.64, 0.33], [0.3, 0.6], [0.15, 0.06]]},\n                'DCI-P3': {color: '#44ff44', points: [[0.68, 0.32], [0.265, 0.69], [0.15, 0.06]]},\n                'Rec. 2020': {color: '#4444ff', points: [[0.708, 0.292], [0.17, 0.797], [0.131, 0.046]]}\n            };\n            \n            Object.entries(spaces).forEach(([name, space]) => {\n                ctx.strokeStyle = space.color;\n                ctx.lineWidth = 2;\n                ctx.beginPath();\n                \n                space.points.forEach((point, i) => {\n                    const x = point[0] * width;\n                    const y = height - (point[1] * height);\n                    if (i === 0) ctx.moveTo(x, y);\n                    else ctx.lineTo(x, y);\n                });\n                ctx.closePath();\n                ctx.stroke();\n                \n                // Add label\n                ctx.fillStyle = space.color;\n                ctx.font = '12px Arial';\n                ctx.fillText(name, space.points[0][0] * width + 10, height - (space.points[0][1] * height));\n            });\n        }\n        \n        // Event listeners\n        document.getElementById('value1').addEventListener('input', () => {\n            updateSliderDisplays();\n            updateConversions();\n        });\n        document.getElementById('value2').addEventListener('input', () => {\n            updateSliderDisplays();\n            updateConversions();\n        });\n        document.getElementById('value3').addEventListener('input', () => {\n            updateSliderDisplays();\n            updateConversions();\n        });\n        document.getElementById('gamma').addEventListener('input', () => {\n            updateSliderDisplays();\n            updateConversions();\n        });\n        document.getElementById('brightness').addEventListener('input', updateSliderDisplays);\n        document.getElementById('inputSpace').addEventListener('change', () => {\n            updateInputLabels();\n            updateConversions();\n        });\n        \n        // Initialize\n        updateSliderDisplays();\n        updateInputLabels();\n        updateConversions();\n        \n        // Redraw chart on window resize\n        window.addEventListener('resize', drawGamutChart);\n    </script>\n</body>\n</html>"